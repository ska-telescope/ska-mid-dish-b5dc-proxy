name: "b5dc-manager-{{.Release.Name}}"
function: telescope-monitoring
domain: general-monitoring
command: "B5DCManager"
server:
  name: "B5DCManager"
  instances:
  {{- range $idx, $dish_id := (.Values.global.dishes | toStrings) }}
    {{- $dish_id := ($dish_id | trim)}}
    - name: "{{ $dish_id }}"
      classes:
        - name: "B5DCManager"
          devices:
            - name: "mid-dish/b5dc-manager/SKA{{ printf "%01s" $dish_id }}"
              properties:
                - name: "SkaLevel"
                  values:
                    - "1"
                - name: "LoggingTargetsDefault"
                  values:
                    - "tango::logger"
                - name: "LoggingLevelDefault"
                  values:
                    - "5"
                - name: "B5DCHost"
                  values:
                    - {{ $.Values.b5dcmanager.host | default {{ printf "b5dc-simulator-%s-svc" $dish_id }} }}
                - name: "B5DCPort"
                  values:
                    - {{ $.Values.b5dcmanager.port | default "1234" }}

  {{- end }}
depends_on:
  - device: sys/database/2
image:
  registry: "{{.Values.b5dcmanager.image.registry}}"
  image: "{{.Values.b5dcmanager.image.image}}"
  tag: "{{.Values.b5dcmanager.image.tag}}"
  pullPolicy: "{{.Values.b5dcmanager.image.pullPolicy}}"
